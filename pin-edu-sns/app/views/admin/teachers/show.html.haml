- htitle '教师维护'

- hbreadcrumb '基础数据管理', '/admin'
- hbreadcrumb '教师维护', '/admin/teachers'
- hbreadcrumb @teacher.real_name


:ruby
  selected_semester = params[:semester].blank? ? Semester.now : Semester.get_by_value(params[:semester])

.page-unfixed-head
  = page_buttons do |p|
    = p.button '返回列表页', '/admin/teachers'
    = p.button '修改信息', "/admin/teachers/#{@teacher.id}/edit"
    = p.button '修改密码', "/admin/teachers/#{@teacher.id}/password"

  = page_semester_filters '/admin/course_surveys'

.page-model-show
  .page-admin-teacher

    .page-field.base-info
      .field-title 教师基础信息
      .field-data
        .base
          .avatar= avatar @teacher.user, :medium
          .name= @teacher.real_name
          .tid= @teacher.tid
        .detail
          .user
            %label 系统用户名
            .v= @teacher.user.name
          .email
            %label 邮箱
            .v= @teacher.user.email

    .page-field.desc
      .field-title 教师简介
      .field-data
        = sanitize @teacher.description

    
    .page-field.courses
      .field-title 该学期下负责的课程

      - @courses.each do |course|
        :ruby
          students = course.get_current_students_of(@teacher.user)
          count = students.count

        .course
          .course-info
            .name= link_to course.name, "/admin/courses/#{course.id}"
            .ops= link_to "分配学生", ""

          .students-brief
            - students[0..4].each do |student|
              .student= avatar_link student, :tiny
            .desc= "等 #{count} 个学生"

            %a.open{:href=>'javascript:;'} 展开

          .students-detail
            .h
              .desc= "总共 #{count} 个学生"
              %a.close{:href=>'javascript:;'} 关闭

            .students
              - students.each do |student|
                .student
                  .avatar= avatar student, :tiny
                  .name= link_to student.real_name, admin_student_path(student)
