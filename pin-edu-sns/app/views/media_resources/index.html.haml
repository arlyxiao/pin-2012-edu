.page-media-resource-head
  =render 'media_resources/parts/search_bar'
  =render 'media_resources/parts/forms'

.page-media-resource-nav
  .go-parent-dir
    - if @current_dir.blank?
      %span.quiet 上一级
    - else
      :ruby
        url = @current_dir.dir.blank? ? '/file' : File.join('/file', @current_dir.dir.path)
      %a{:href => url} 上一级

  .navs
    %span= link_to '根目录', '/file'
    - media_resource_navs_dirs(@current_dir).each do |dir|
      %span= link_to dir.name, File.join('/file', dir.path)

.page-media-resources
  - resources = @media_resources

  - if resources.blank?
    .media-resource-blank.quiet
      该目录下没有资源

  - resources.each do |resource|
    :ruby
      cover_src = media_resource_cover_src(resource)
      title = truncate_u resource.name, 10
      creator_name = resource.creator.name
      creator_avatar_src = resource.creator.logo.url
      uploaded_at = resource.created_at
      is_dir = resource.is_dir?
      resource_url = File.join('/file', resource.path)

    %a.media-resource{:href=>'javascript:;', |
      :'data-id'=> resource.id, |
      :'data-resource-url'=> resource_url, |
      :'data-title'=>title, |
      :'data-uploaded-at'=>uploaded_at, |
      :'data-creator-name'=>creator_name, |
      :'data-creator-avatar-src'=>creator_avatar_src, |
      :'data-is-dir'=> is_dir.to_s}
      .meta-box
        .cover{:'data-src'=>cover_src}
        .title=title
      .detail-box


.page-media-resource-show-wrapper{:style=>'display:none;'}
  .box
    .header
      .hbox
        .avatar
        .title
        .meta
          %span.creator-name
          %span 上传于
          %span.uploaded-at

      %a.close{:href=>'javascript:;'}
    .bd
      .cover


.upload-box
  = render :template => 'slice_temp_files/new_upload_page'