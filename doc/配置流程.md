#工程部署方式是  nginx + unicorn，开发坏境也是  nginx + unicorn 的方式运行<br/>
##首先需要安装 nginx 和 unicorn，目前 nginx 用的 0.8.55 版本，unicorn 用的 4.1.1 版本<br/>
###安装 nginx<br/>
```
  tar zxvf nginx-0.8.55.tar.gz
  cd nginx-0.8.55
  ./configure
  make
  make install
```

###安装 unicorn<br/>
```
  gem install unicorn --version=4.1.1
```

###nginx 配置<br/>
  参考[这个文件](https://github.com/mindpin-shcmusic/pin-2012-edu/blob/master/doc/nginx.conf.demo)中，标注出来的部分

##安装工程依赖 Gem<br/>
首先删除 /web/2012/pin-2012-edu/lib/Gemfile.lock 这个文件<br/>
然后运行：<br/>

```
  cd /web/2012/pin-2012-edu/lib
  bundle install
```

###从 Github clone 工程代码
#工程的根路径必须是  /web/2012/pin-2012-edu
```
  # 工程的根路径必须是  /web/2012/pin-2012-edu
  mkdir -p /web/2012
  cd /web/2012
  git clone git://github.com/mindpin-shcmusic/pin-2012-edu.git
  # 在 /web/2012/ 目录下创建三个文件夹  logs pids sockets
  mkdir /web/2012/logs
  mkdir /web/2012/pids
  mkdir /web/2012/sockets
```

###工程的目录结构说明

    apps 是 三个 Rails 工程
    
      |----- pin-admin    系统维护工程
      
      |----- pin-auth     用户认证工程
      
      |----- pin-edu-sns  业务逻辑工程
      
    sh              一些管理脚本
    
    lib             所有 Rails 工程都会用到的公共代码
    
    management      管理各种服务（启动，暂停，重启，查看日志）的  Rails 工程
    
###开发环境需要增加HOSTS 配置<br/>
给 hosts 文件增加几个域名映射，linux hosts 文件在 /etc/hosts<br>
####增加以下几个映射<br/>
```
  127.0.0.1 dev.management.yinyue.edu
  127.0.0.1 dev.auth.yinyue.edu
  127.0.0.1 dev.admin.yinyue.edu
  127.0.0.1 dev.sns.yinyue.edu
  127.0.0.1 dev.ui.yinyue.edu
```

###创建数据库和数据表<br/>
####/web/2012/pin-2012-edu/apps/pin-admin<br/>
####/web/2012/pin-2012-edu/apps/pin-auth<br/>
####/web/2012/pin-2012-edu/apps/pin-edu-sns<br/>

上边三个工程都有 migration 文件，三个工程用了同一个数据库

  1 创建数据库<br/>
    因为三个工程共用同一个数据库，所以在以上三个工程目录的任意一个下边，运行 rake db:create
    
  2 创建数据表<br/>
    分别在以上三个工程目录下运行 rake db:migrate

###启动 management 工程<br/>
```
  cd pin-2012-edu/sh
  ./unicorn_management.sh start
```
 
浏览器访问  dev.management.yinyue.edu，输入用户名密码，进入管理界面，可以看到 pin-auth,pin-admin,pin-edu-sns 工程的状态，并且可以开启或者关闭这几个工程<br/>